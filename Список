#include <iostream>

struct Node 
{
	Node* next;
	Node* prev;
	int data;
};

Node* head = nullptr;
Node* tail = nullptr;
Node* stare = nullptr;
Node* temp = nullptr;
Node* tmp = nullptr;
Node* tmpend = nullptr;

void Kill(Node*& head, Node*& tail)
{
	Node* carrent;
	carrent = head;
	while (carrent->next != nullptr)
	{
		carrent = carrent->next;
		delete(head);
		head = carrent;
	}
	head = tail;
	delete(head);
	delete(tail);
	tail = nullptr;
	head = nullptr;
	std::cout << "Список пуст ";
}

void AddElem(Node*& head, Node*& tail, int n)
{
	Node* elem;
	Node* carrent;
	if (head == nullptr)
	{
		head = new Node;
		head->data = n;
		head->next = nullptr;
		head->prev = nullptr;
		tail = head;
	}
	else
	{
		carrent = head;
			if ((head->data > n)&&(head->data!=n))
			{
				elem = new Node;
				elem->next = head;
				elem->prev = nullptr;
				elem->data = n;
				head->prev = elem;
				head = elem;
			}
			else
			{
				while (carrent->next != nullptr)
				{
					if ((carrent->data < n) && (carrent->data!=n))
						carrent = carrent->next;
					else
						break;
				}
				if ((carrent->data > n) && (carrent->data != n))
				{
					elem = new Node;
					elem->data = n;
					elem->prev = carrent->prev;
					carrent->prev->next = elem;
					elem->next = carrent;
					carrent->prev = elem;
				}
				else if ((carrent->data < n) && (carrent->data != n))
				{
					elem = new Node;
					carrent->next = elem;
					elem->next = nullptr;
					elem->prev = carrent;
					elem->data = n;
					tail = elem;
				}
			}
	}
}

void DelElem(Node*& head, Node*& tail, int dm)
{
	Node* elem;
	Node* carrent;
	carrent = head;
	if (head == nullptr)
		std::cout << "Список пуст ";
	else
	{
		if ((head->data == dm) && (carrent->next != nullptr))
		{
			elem = head;
			head->next->prev = nullptr;
			head = head->next;
			delete(elem);
		}
		else if (head->data != dm)
		{
			while ((carrent->data != dm) && (carrent->next != nullptr))
			{
				carrent = carrent->next;
			}
			if ((carrent->data == dm) && (carrent->next != nullptr))
			{
				carrent->next->prev = carrent->prev;
				carrent->prev->next = carrent->next;
				delete(carrent);
			}
			else if ((carrent->data == dm) && (carrent->next == nullptr))
			{
				tail = carrent->prev;
				carrent->prev->next = nullptr;
				delete(carrent);
			}
			else
				std::cout << "Такого числа нет " << std::endl;
		}
		else if ((head->prev == nullptr) && (head->next == nullptr))
		{
			tail = head;
			delete(tail);
			delete(head);
			tail = nullptr;
			head = nullptr;
		}
	}
}

void Serch(Node*& head, Node* tail, int dm)
{
	bool f = 0;
	Node* carrent;
	if (head == nullptr)
		std::cout << "Список пуст " << std::endl;
	else
	{
		carrent = head;
		while (carrent != nullptr)
		{
			if (carrent->data == dm)
			{
				std::cout << carrent->data << " ";
				f = 1;
			}
			carrent = carrent->next;
		}
		if (f == 0)
			std::cout << "Такого элемента в списке нет ";
		std::cout << std::endl;
	}
}

void PrintList(Node* head, Node* tail)
{
	Node* carrent;
	if (head == nullptr)
		std::cout << "Список пуст "<<std::endl;
	else 
	{
		carrent = head;
		while (carrent != nullptr)
		{
			std::cout << carrent->data << " ";
			carrent = carrent->next;
		}
		std::cout << std::endl;
	}
}

 void AddLists(Node*& stare, Node* temp, Node* head, Node*tail, Node* tmp, Node* tmpend)
{
	 Node* carrent;
	 carrent = stare;
	 while (head != nullptr)
	 {
		 AddElem(stare, temp, head->data);
		 head = head->next;
	 }
	 while (tmp != nullptr)
	 {
		 while (carrent != nullptr)
		 {
			 if ((tmp->data == carrent->data)&&(tmp != nullptr))
			 { 
				 tmp = tmp->next;
				 carrent = stare;
			 }
			 else
			 {
				 carrent = carrent->next;
			 }
		 }
		 AddElem (stare, temp, tmp->data);
		 tmp = tmp->next;
		 carrent = stare;
	 }
}

int main()
{
	int k, dm;
	setlocale(LC_ALL, "Russian");
	Node* P_begin = nullptr;
	Node* P_end = nullptr;
	Node* P_result = nullptr;
	Node* P_begin1 = nullptr;
	Node* P_end1 = nullptr;
	Node* P_result1 = nullptr;
	std::cout << "Введите количество элементов в списке: ";
	std::cin >> k;
	std::cout << "Введите элементы списка: " << std::endl;
	for (int i = 0; i < k; i++)
	{
		std::cin >> dm;
		AddElem(P_begin, P_begin1, dm);
	}
	PrintList(P_begin, P_begin1);
	//Kill(P_begin, P_begin1);
	std::cout << "Введите какой элемент удалить: ";
	std::cin >> dm;
	DelElem(P_begin, P_begin1, dm);
	PrintList(P_begin, P_begin1);
	std::cout << P_begin1->data << std::endl;
	std::cout << "Введите какой элемент хотите найти: ";
	std::cin >> dm;
	Serch(P_begin, P_begin1, dm);
	std::cout << "Введите количество элементов в списке: ";
	std::cin >> k;
	std::cout << "Введите элементы списка: " << std::endl;
	for (int i = 0; i < k; i++)
	{
		std::cin >> dm;
		AddElem(P_end, P_end1, dm);
	}
	PrintList(P_end, P_end1);
	//Kill(P_end, P_end1);
	AddLists(P_result, P_result1, P_begin, P_begin1, P_end, P_end1);
	PrintList(P_result, P_result1);
	Kill(P_result, P_result1);
	return 0;
}
